source('~/R/gap/R/pqtl2dplotly.R')
INF <- Sys.getenv("INF")
d <- read.csv(file.path(INF,"work","INF1.merge.cis.vs.trans"),as.is=TRUE)
r <- pqtl2dplotly(d)
library(gap)
r <- pqtl2dplotly(d)
library(dplyr)
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
d
chrlen=gap::hg19
n <- CM <- snpid <- pos_pqtl <- pos_prot <- prot_gene <- lp <- chr1 <- pos1 <- chr2 <- pos2 <- target <- gene <- log10p <- NA
t2d <- pqtl2dplot(d, chrlen, plot=FALSE)
n <- with(t2d, n)
CM <- with(t2d, CM)
tkvals <- tktxts <- vector()
for (x in 1:n) {
tkvals[x] <- ifelse(x == 1, CM[x]/2, (CM[x] + CM[x-1])/2)
tktxts[x] <- xy(x)
}
t2d_pos <- with(t2d, data) %>%
mutate(cistrans=if_else(col=="blue","cis","trans"))
t2d_pos <- t2d_pos %>% dplyr::mutate(snpid=paste("SNPid:",id),pos_pqtl=paste0("pQTL: ",chr1,":",pos1),
pos_prot=paste0("Protein: ",chr2,":",pos2),
prot_gene=paste0("target (gene):", target, "(", gene, ")"),
lp=paste("-log10(P):", -log10p))
lp=paste("-log10(P):", -log10p))
f <- list(
family = "Courier New, monospace",
size = 18,
color = "#7f7f7f"
)
f <- list(
family = "Courier New, monospace",
size = 18,
color = "#7f7f7f"
)
source('~/R/gap/R/pqtl2dplotly.R')
source('~/R/gap/R/pqtl2dplotly.R')
pqtl(d)
pqtl2dplotly(d)
source('~/R/gap/R/pqtl2dplotly.R')
pqtl2dplotly(d)
r <- pqtl2dplotly(d)
r
n
tkvals
tktxts
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
?plot_ly
?yaxisx
?plotly::yaxis
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
dev.off()
source('~/R/gap/R/pqtl2dplotly.R')
r <- pqtl2dplotly(d)
r
